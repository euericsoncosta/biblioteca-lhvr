<div class="mb-8 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
  <div>
    <h2 class="text-3xl font-black text-slate-800 dark:text-white tracking-tight">Materiais de RevisÃ£o ðŸ“š</h2>
    <p class="text-slate-500 dark:text-slate-400 font-medium text-sm">ConteÃºdos organizados para o seu estudo e revisÃ£o.</p>
  </div>

  {{#unless (eq user.tipo_usuario 'ALUNO')}}
    <a href="/materiais/novo" class="px-6 py-3 bg-indigo-600 text-white rounded-2xl font-black text-sm shadow-xl hover:bg-indigo-700 transition-all flex items-center gap-2 active:scale-95">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4" />
      </svg>
      Publicar ConteÃºdo
    </a>
  {{/unless}}
</div>

<div class="bg-white dark:bg-slate-800 p-6 rounded-[2rem] shadow-sm border border-slate-100 dark:border-slate-700 mb-8 transition-all">
  <form action="/materiais" method="GET" class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
    
    <div>
      <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1 tracking-widest">SÃ©rie</label>
      <select name="ano_escolar" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-2xl p-3 outline-none dark:text-white">
        <option value="">Todas</option>
        <option value="1" {{#if (eq filtros.ano_escolar '1')}}selected{{/if}}>1Âº Ano</option>
        <option value="2" {{#if (eq filtros.ano_escolar '2')}}selected{{/if}}>2Âº Ano</option>
        <option value="3" {{#if (eq filtros.ano_escolar '3')}}selected{{/if}}>3Âº Ano</option>
      </select>
    </div>

    <div>
      <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1 tracking-widest">Bimestre</label>
      <select name="bimestre" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-2xl p-3 outline-none dark:text-white">
        <option value="">Todos</option>
        <option value="1" {{#if (eq filtros.bimestre '1')}}selected{{/if}}>1Âº Bim</option>
        <option value="2" {{#if (eq filtros.bimestre '2')}}selected{{/if}}>2Âº Bim</option>
        <option value="3" {{#if (eq filtros.bimestre '3')}}selected{{/if}}>3Âº Bim</option>
        <option value="4" {{#if (eq filtros.bimestre '4')}}selected{{/if}}>4Âº Bim</option>
      </select>
    </div>

    <div>
      <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1 tracking-widest">Disciplina / Curso</label>
      <select name="disciplina" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-2xl p-3 outline-none dark:text-white">
        <option value="">Todas</option>
        <optgroup label="Base Comum">
          <option value="PortuguÃªs" {{#if (eq filtros.disciplina 'PortuguÃªs')}}selected{{/if}}>PortuguÃªs</option>
          <option value="MatemÃ¡tica" {{#if (eq filtros.disciplina 'MatemÃ¡tica')}}selected{{/if}}>MatemÃ¡tica</option>
          <option value="HistÃ³ria" {{#if (eq filtros.disciplina 'HistÃ³ria')}}selected{{/if}}>HistÃ³ria</option>
          <option value="Geografia" {{#if (eq filtros.disciplina 'Geografia')}}selected{{/if}}>Geografia</option>
          <option value="Biologia" {{#if (eq filtros.disciplina 'Biologia')}}selected{{/if}}>Biologia</option>
          <option value="FÃ­sica" {{#if (eq filtros.disciplina 'FÃ­sica')}}selected{{/if}}>FÃ­sica</option>
          <option value="QuÃ­mica" {{#if (eq filtros.disciplina 'QuÃ­mica')}}selected{{/if}}>QuÃ­mica</option>
        </optgroup>
        <optgroup label="Cursos TÃ©cnicos">
          <option value="InformÃ¡tica" {{#if (eq filtros.disciplina 'InformÃ¡tica')}}selected{{/if}}>InformÃ¡tica</option>
          <option value="FinanÃ§as" {{#if (eq filtros.disciplina 'FinanÃ§as')}}selected{{/if}}>FinanÃ§as</option>
          <option value="Enfermagem" {{#if (eq filtros.disciplina 'Enfermagem')}}selected{{/if}}>Enfermagem</option>
          <option value="AgronegÃ³cio" {{#if (eq filtros.disciplina 'AgronegÃ³cio')}}selected{{/if}}>AgronegÃ³cio</option>
          <option value="SeguranÃ§a do Trabalho" {{#if (eq filtros.disciplina 'SeguranÃ§a do Trabalho')}}selected{{/if}}>SeguranÃ§a do Trabalho</option>
        </optgroup>
      </select>
    </div>

    <div>
      <label class="block text-[10px] font-black uppercase text-slate-400 mb-2 ml-1 tracking-widest">Ano Letivo</label>
      <input type="number" name="ano_referencia" value="{{#if filtros.ano_referencia}}{{filtros.ano_referencia}}{{else}}2024{{/if}}" class="w-full bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-2xl p-3 outline-none dark:text-white">
    </div>

    <button type="submit" class="bg-indigo-600 text-white py-3.5 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-indigo-700 transition-all shadow-lg">
      Filtrar
    </button>
  </form>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {{#each materiais}}
    <div class="bg-white dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700 p-6 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all flex flex-col group relative">
      
      <div class="flex justify-between items-start mb-4">
        <span class="px-3 py-1 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-lg text-[10px] font-black uppercase tracking-widest">
          {{this.disciplina}}
        </span>
        <div class="flex gap-1.5">
          <span class="px-2 py-1 bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 rounded-md text-[9px] font-black">
            {{this.ano_escolar}}Âº ANO
          </span>
          <span class="px-2 py-1 bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400 rounded-md text-[9px] font-black uppercase">
            {{this.bimestre}}Âº BIM
          </span>
        </div>
      </div>

      <h3 class="text-lg font-black text-slate-800 dark:text-white mb-2 leading-tight group-hover:text-indigo-600 transition-colors">
        {{this.titulo}}
      </h3>
      
      <p class="text-sm text-slate-500 dark:text-slate-400 mb-6 line-clamp-2 italic">
        {{#if this.descricao}}{{this.descricao}}{{else}}Sem descriÃ§Ã£o adicional.{{/if}}
      </p>

      <div class="mt-auto pt-6 border-t border-slate-50 dark:border-slate-700 flex justify-between items-center">
        <div class="flex flex-col">
          <span class="text-[9px] font-black uppercase text-slate-300 dark:text-slate-500 tracking-widest">Professor</span>
          <span class="text-xs font-bold text-slate-600 dark:text-slate-300">{{this.professor.nome}}</span>
        </div>
        
        <a href="{{this.link_recurso}}" target="_blank" class="px-5 py-2.5 bg-emerald-600 text-white rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-emerald-700 transition-all shadow-lg shadow-emerald-100 dark:shadow-none active:scale-95">
          Aceder Recurso
        </a>
      </div>

      {{#if (eq ../user.tipo_usuario 'ADMIN')}}
        <div class="mt-4 border-t border-slate-100 dark:border-slate-700 pt-4 flex justify-center">
          <form action="/materiais/delete/{{this.id}}" method="POST" onsubmit="return confirm('Deseja eliminar este material de estudo permanentemente?')">
            <button type="submit" class="flex items-center gap-2 text-[10px] font-black uppercase text-rose-400 hover:text-rose-600 transition-colors tracking-widest">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
              Eliminar Material
            </button>
          </form>
        </div>
      {{/if}}
    </div>
  {{else}}
    <div class="col-span-full py-24 text-center bg-white dark:bg-slate-800 rounded-[3rem] border border-slate-100 dark:border-slate-700">
      <div class="text-slate-200 dark:text-slate-700 mb-4 flex justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5S19.832 5.477 21 6.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
        </svg>
      </div>
      <p class="text-slate-400 font-bold uppercase tracking-[0.2em] text-xs">Nenhum conteÃºdo publicado para estes filtros.</p>
    </div>
  {{/each}}
</div>